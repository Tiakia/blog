<!DOCTYPE html>
<html lang="zh-CN">
  <head><meta name="generator" content="Hexo 3.8.0">
    
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">


<meta http-equiv="Cache-Control" content="no-transform">
<meta http-equiv="Cache-Control" content="no-siteapp">

<meta name="theme-color" content="#f8f5ec">
<meta name="msapplication-navbutton-color" content="#f8f5ec">
<meta name="apple-mobile-web-app-capable" content="yes">
<meta name="apple-mobile-web-app-status-bar-style" content="#f8f5ec">



  <meta name="description" content="基于antd封装的模态框新增编辑组件">




  <meta name="keywords" content="React,React Native,微信小程序,Webpack,Javascript">










  <link rel="alternate" href="/atom.xml" title="Tiankai's Blog">




  <link rel="shortcut icon" type="image/x-icon" href="/favicon.ico?v=2.10.1">



<link rel="canonical" href="http://www.tiankai.party/posts/54457/">



  <link rel="stylesheet" type="text/css" href="/lib/fancybox/jquery.fancybox.css">




  <link rel="stylesheet" type="text/css" href="/lib/nprogress/nprogress.min.css">



<link rel="stylesheet" type="text/css" href="/css/style.css?v=2.10.1">



  
  <script id="baidu_analytics">
    var _hmt = _hmt || [];
    (function() {
      var hm = document.createElement("script");
      hm.src = "https://hm.baidu.com/hm.js?661158ab1e0fccea66251d60f7dae96a";
      var s = document.getElementsByTagName("script")[0];
      s.parentNode.insertBefore(hm, s);
    })();
  </script>




  <script id="baidu_push">
(function(){
    var bp = document.createElement('script');
    var curProtocol = window.location.protocol.split(':')[0];
    if (curProtocol === 'https') {
        bp.src = 'https://zz.bdstatic.com/linksubmit/push.js';
    }
    else {
        bp.src = 'http://push.zhanzhang.baidu.com/push.js';
    }
    var s = document.getElementsByTagName("script")[0];
    s.parentNode.insertBefore(bp, s);
})();
</script>









<script>
  window.config = {"leancloud":{"app_id":"","app_key":""},"toc":true,"fancybox":true,"pjax":true};
</script>

    <title> 基于antd封装的模态框新增编辑组件 - Tiankai's Blog </title>
  </head>

  <body><div id="mobile-navbar" class="mobile-navbar">
  <div class="mobile-header-logo">
    <a href="/." class="logo">Tiankai's Blog</a>
  </div>
  <div class="mobile-navbar-icon">
    <span></span>
    <span></span>
    <span></span>
  </div>
</div>

<nav id="mobile-menu" class="mobile-menu slideout-menu">
  <ul class="mobile-menu-list">
    
      <a href="/">
        <li class="mobile-menu-item">
          
          
            首页
          
        </li>
      </a>
    
      <a href="/archives/">
        <li class="mobile-menu-item">
          
          
            归档
          
        </li>
      </a>
    
      <a href="/tags">
        <li class="mobile-menu-item">
          
          
            标签
          
        </li>
      </a>
    
      <a href="/categories">
        <li class="mobile-menu-item">
          
          
            分类
          
        </li>
      </a>
    
      <a href="/about">
        <li class="mobile-menu-item">
          
          
            关于
          
        </li>
      </a>
    
      <a href="/comments">
        <li class="mobile-menu-item">
          
          
            留言板
          
        </li>
      </a>
    
  </ul>
</nav>

    <div class="container" id="mobile-panel">
      <header id="header" class="header"><div class="logo-wrapper">
  <a href="/." class="logo">Tiankai's Blog</a>
</div>

<nav class="site-navbar">
  
    <ul id="menu" class="menu">
      
        <li class="menu-item">
          <a class="menu-item-link" href="/">
            
            
              首页
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/archives/">
            
            
              归档
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/tags">
            
            
              标签
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/categories">
            
            
              分类
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/about">
            
            
              关于
            
          </a>
        </li>
      
        <li class="menu-item">
          <a class="menu-item-link" href="/comments">
            
            
              留言板
            
          </a>
        </li>
      
    </ul>
  
</nav>
<a href="https://github.com/tiakia"><img style="position:fixed;top:0;right:0;" width="149" height="149" src="https://github.blog/wp-content/uploads/2008/12/forkme_right_red_aa0000.png?resize=149%2C149" class="attachment-full size-full" alt="Fork me on GitHub" data-recalc-dims="1"></a>


      </header>

      <main id="main" class="main">
        <div class="content-wrapper">
          <div id="content" class="content">
            
  
  <article class="post">
    <header class="post-header">
      <h1 class="post-title">
        
          基于antd封装的模态框新增编辑组件
        
      </h1>

      <div class="post-meta">
        <span class="post-time">
        2019-12-11
        </span>
        
          <span class="post-category">
            
              <a href="/categories/javascript/">javascript</a>
            
          </span>
        
        <span class="post-counts">
          Count: 1.4k 字
        </span>
        <span class="post-times">
          Time: 7 分钟
        </span>
        <!-- <span class="post-visits leancloud-visitors" -->
        <!--      data-url="/posts/54457/" -->
        <!--      data-title="基于antd封装的模态框新增编辑组件" -->
        <!--      id="/posts/54457/" -->
        <!--      data-flag-title="基于antd封装的模态框新增编辑组件"> -->
        <!--   阅读次数 0 -->
        <!--    <i class="leancloud-visitors-count"></i> -->
        <!-- </span> -->
      </div>
    </header>

    
    
  <div class="post-toc" id="post-toc">
    <h2 class="post-toc-title">文章目录</h2>
    <div class="post-toc-content">
      <ol class="toc"><li class="toc-item toc-level-2"><a class="toc-link" href="#JSON对象"><span class="toc-text">JSON对象</span></a></li><li class="toc-item toc-level-2"><a class="toc-link" href="#封装代码"><span class="toc-text">封装代码</span></a></li></ol>
    </div>
  </div>



    <div class="post-content">
      
        <p>在项目中有很多类似的功能，比如说新增的时候弹出一个模态框，填写表单后提交完成新增，或者是编辑的时候弹出模态框，填写表单后提交完成编辑。所以我基于<code>antd</code>做了一个封装,可以根据<code>JSON</code>数据来生成一个，表单提交模态框。<br><a id="more"></a><br>先上截图：<br><img src="/images/antModal-1.png" alt="tpms-select"><br><img src="/images/antModal-2.png" alt="tpms-treeselect"></p>
<p>从截图可以看出生成的表单模态框中表单类型可以是下拉选择、树形选择也可以是单选框、多选框或者是文件上传，而生成这些只需要我们写一个<code>JSON</code>对象就可以。</p>
<h2 id="JSON对象"><a href="#JSON对象" class="headerlink" title="JSON对象"></a>JSON对象</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">let</span> formProps = &#123;</span><br><span class="line">  modalTitle: <span class="string">"添加需求意向"</span>,</span><br><span class="line">  record: [],</span><br><span class="line">  title: &#123;</span><br><span class="line">    name: <span class="string">"标题"</span>,</span><br><span class="line">    actual: <span class="string">"title"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  desc: &#123;</span><br><span class="line">    name: <span class="string">"描述"</span>,</span><br><span class="line">    actual: <span class="string">"desc"</span>,</span><br><span class="line">    rules: [&#123; <span class="attr">required</span>: <span class="literal">false</span>, <span class="attr">message</span>: <span class="string">"请填写描述信息"</span> &#125;]</span><br><span class="line">  &#125;,</span><br><span class="line">  projNo: &#123;</span><br><span class="line">    name: <span class="string">"项目编号"</span>,</span><br><span class="line">    actual: <span class="string">"proj_no"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  pmUserNo: &#123;</span><br><span class="line">    name: <span class="string">"项目经理工号"</span>,</span><br><span class="line">    actual: <span class="string">"pm_user_no"</span>,</span><br><span class="line">    inputProps: &#123;</span><br><span class="line">      type: <span class="string">"treeSelect"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    rules: [&#123; <span class="attr">required</span>: <span class="literal">false</span>, <span class="attr">message</span>: <span class="string">"请选择项目经理工号"</span> &#125;],</span><br><span class="line">    options: <span class="keyword">this</span>.state.proGroup</span><br><span class="line">  &#125;,</span><br><span class="line">  acptUserNo: &#123;</span><br><span class="line">    name: <span class="string">"受理人员工编号"</span>,</span><br><span class="line">    actual: <span class="string">"acpt_user_no"</span>,</span><br><span class="line">    inputProps: &#123;</span><br><span class="line">      type: <span class="string">"treeSelect"</span></span><br><span class="line">    &#125;,</span><br><span class="line">    rules: [&#123; <span class="attr">required</span>: <span class="literal">false</span>, <span class="attr">message</span>: <span class="string">"请选择受理人员工编号"</span> &#125;],</span><br><span class="line">    options: <span class="keyword">this</span>.state.proGroup</span><br><span class="line">  &#125;,</span><br><span class="line">  dept_no: &#123;</span><br><span class="line">    name: <span class="string">"提出部门"</span>,</span><br><span class="line">    actual: <span class="string">"dept_no"</span></span><br><span class="line">  &#125;,</span><br><span class="line">  attach: &#123;</span><br><span class="line">      name: <span class="string">"附件"</span>,</span><br><span class="line">      actual: <span class="string">"attach"</span>,</span><br><span class="line">      inputProps: &#123;</span><br><span class="line">        type: <span class="string">"upload"</span>,</span><br><span class="line">        uploadProps: &#123;&#125;</span><br><span class="line">     &#125;</span><br><span class="line">  &#125;,</span><br><span class="line">  status: &#123;</span><br><span class="line">    name: <span class="string">"状态"</span>,</span><br><span class="line">    actual: <span class="string">"status"</span>,</span><br><span class="line">    inputProps: &#123;</span><br><span class="line">      type: <span class="string">"select"</span>,</span><br><span class="line">      selectProps: &#123; <span class="attr">selName</span>: <span class="string">"arg_name"</span>, <span class="attr">selVal</span>: <span class="string">"arg_value"</span> &#125;</span><br><span class="line">    &#125;,</span><br><span class="line">    rules: [&#123; <span class="attr">required</span>: <span class="literal">false</span>, <span class="attr">message</span>: <span class="string">"请选择状态"</span> &#125;],</span><br><span class="line">    options: status</span><br><span class="line">  &#125;</span><br><span class="line">&#125;;</span><br></pre></td></tr></table></figure>
<p>我们来解释一下每个字段的意思：</p>
<ul>
<li><code>modalTitle</code>: 这个是展示模态框标题的</li>
<li><code>record</code>: 如果是新增那么<code>record</code>值为空对象或者数组，如果为编辑，那值为对象，对象的<code>key</code>为每个表单对象的<code>actual</code>字段</li>
<li><p>针对每个表单对象来说，以上面的<code>status</code>举例:</p>
<ul>
<li>表单对象的Key(<code>status</code>)可以随意，真实取值的是<code>actual</code>字段的值（这里建议写成一样的）</li>
<li><code>name</code> <code>FormItem</code>组件的<code>label</code></li>
<li><code>actual</code>表单提交到后端时的字段名称</li>
<li><p><code>inputProps</code>标识表单类型和其他表单属性</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line">areaID: &#123;</span><br><span class="line">  name: <span class="string">'区域编号'</span>,</span><br><span class="line">  rules: [&#123; <span class="attr">required</span>: <span class="literal">true</span> &#125;],</span><br><span class="line">  inputProps: &#123; <span class="attr">disabled</span>: <span class="literal">true</span>, <span class="attr">type</span>: <span class="string">'number'</span> &#125;,</span><br><span class="line">  actual: <span class="string">'area_id'</span>,</span><br><span class="line">&#125;,</span><br></pre></td></tr></table></figure>
<p>  要注意的是，如果表单为下拉选，可以在这里标明<code>options</code>的<code>key</code>和<code>value</code>。</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br></pre></td><td class="code"><pre><span class="line">inputProps: &#123;</span><br><span class="line">    type: <span class="string">"select"</span>,</span><br><span class="line">    selectProps: &#123; <span class="attr">selName</span>: <span class="string">"arg_name"</span>, <span class="attr">selVal</span>: <span class="string">"arg_value"</span> &#125;</span><br><span class="line">  &#125;,</span><br></pre></td></tr></table></figure>
</li>
<li><p><code>rules</code>表单的规则</p>
</li>
<li><p><code>options</code>如果表单为下拉选的时候需要，对于<code>status</code>表单对象来说，他的<code>options</code>应该是这样的：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> status = [</span><br><span class="line">  &#123; <span class="attr">arg_value</span>: <span class="string">"1"</span>, <span class="attr">arg_name</span>: <span class="string">"提交"</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">arg_value</span>: <span class="string">"2"</span>, <span class="attr">arg_name</span>: <span class="string">"受理"</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">arg_value</span>: <span class="string">"3"</span>, <span class="attr">arg_name</span>: <span class="string">"分配"</span> &#125;,</span><br><span class="line">  &#123; <span class="attr">arg_value</span>: <span class="string">"9"</span>, <span class="attr">arg_name</span>: <span class="string">"拒绝"</span> &#125;</span><br><span class="line">];</span><br></pre></td></tr></table></figure>
<p>  它的<code>key</code>,<code>value</code>正好对应<code>inputProps</code>重点<code>selName</code>,<code>selVal</code></p>
</li>
<li><p>如果多个表单对象是展示在一行的那么这几个表单对象应该这样写：</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br></pre></td><td class="code"><pre><span class="line">....</span><br><span class="line"> groups3: &#123;</span><br><span class="line">    revenuesV0: &#123;</span><br><span class="line">      name: <span class="string">`<span class="subst">$&#123;moment().format(<span class="string">'YYYY'</span>)&#125;</span>年财政总收入`</span>,</span><br><span class="line">      actual: <span class="string">'revenues_v0'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    revenuesV1: &#123;</span><br><span class="line">      name: <span class="string">`<span class="subst">$&#123;moment()</span></span></span><br><span class="line"><span class="string"><span class="subst">        .subtract(<span class="number">1</span>, <span class="string">'y'</span>)</span></span></span><br><span class="line"><span class="string"><span class="subst">        .format(<span class="string">'YYYY'</span>)&#125;</span>年财政总收入`</span>,</span><br><span class="line">      actual: <span class="string">'revenues_v1'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line">    revenuesV2: &#123;</span><br><span class="line">      name: <span class="string">`<span class="subst">$&#123;moment()</span></span></span><br><span class="line"><span class="string"><span class="subst">        .subtract(<span class="number">2</span>, <span class="string">'y'</span>)</span></span></span><br><span class="line"><span class="string"><span class="subst">        .format(<span class="string">'YYYY'</span>)&#125;</span>年财政总收入`</span>,</span><br><span class="line">      actual: <span class="string">'revenues_v2'</span>,</span><br><span class="line">    &#125;,</span><br><span class="line"> &#125;,</span><br><span class="line">...</span><br></pre></td></tr></table></figure>
<p>  重要的<code>groups</code>,至于后面的数字只是为了标明第几组。</p>
</li>
</ul>
</li>
</ul>
<h2 id="封装代码"><a href="#封装代码" class="headerlink" title="封装代码"></a>封装代码</h2><figure class="highlight javascript"><figcaption><span>ModalForm.js</span></figcaption><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br><span class="line">16</span><br><span class="line">17</span><br><span class="line">18</span><br><span class="line">19</span><br><span class="line">20</span><br><span class="line">21</span><br><span class="line">22</span><br><span class="line">23</span><br><span class="line">24</span><br><span class="line">25</span><br><span class="line">26</span><br><span class="line">27</span><br><span class="line">28</span><br><span class="line">29</span><br><span class="line">30</span><br><span class="line">31</span><br><span class="line">32</span><br><span class="line">33</span><br><span class="line">34</span><br><span class="line">35</span><br><span class="line">36</span><br><span class="line">37</span><br><span class="line">38</span><br><span class="line">39</span><br><span class="line">40</span><br><span class="line">41</span><br><span class="line">42</span><br><span class="line">43</span><br><span class="line">44</span><br><span class="line">45</span><br><span class="line">46</span><br><span class="line">47</span><br><span class="line">48</span><br><span class="line">49</span><br><span class="line">50</span><br><span class="line">51</span><br><span class="line">52</span><br><span class="line">53</span><br><span class="line">54</span><br><span class="line">55</span><br><span class="line">56</span><br><span class="line">57</span><br><span class="line">58</span><br><span class="line">59</span><br><span class="line">60</span><br><span class="line">61</span><br><span class="line">62</span><br><span class="line">63</span><br><span class="line">64</span><br><span class="line">65</span><br><span class="line">66</span><br><span class="line">67</span><br><span class="line">68</span><br><span class="line">69</span><br><span class="line">70</span><br><span class="line">71</span><br><span class="line">72</span><br><span class="line">73</span><br><span class="line">74</span><br><span class="line">75</span><br><span class="line">76</span><br><span class="line">77</span><br><span class="line">78</span><br><span class="line">79</span><br><span class="line">80</span><br><span class="line">81</span><br><span class="line">82</span><br><span class="line">83</span><br><span class="line">84</span><br><span class="line">85</span><br><span class="line">86</span><br><span class="line">87</span><br><span class="line">88</span><br><span class="line">89</span><br><span class="line">90</span><br><span class="line">91</span><br><span class="line">92</span><br><span class="line">93</span><br><span class="line">94</span><br><span class="line">95</span><br><span class="line">96</span><br><span class="line">97</span><br><span class="line">98</span><br><span class="line">99</span><br><span class="line">100</span><br><span class="line">101</span><br><span class="line">102</span><br><span class="line">103</span><br><span class="line">104</span><br><span class="line">105</span><br><span class="line">106</span><br><span class="line">107</span><br><span class="line">108</span><br><span class="line">109</span><br><span class="line">110</span><br><span class="line">111</span><br><span class="line">112</span><br><span class="line">113</span><br><span class="line">114</span><br><span class="line">115</span><br><span class="line">116</span><br><span class="line">117</span><br><span class="line">118</span><br><span class="line">119</span><br><span class="line">120</span><br><span class="line">121</span><br><span class="line">122</span><br><span class="line">123</span><br><span class="line">124</span><br><span class="line">125</span><br><span class="line">126</span><br><span class="line">127</span><br><span class="line">128</span><br><span class="line">129</span><br><span class="line">130</span><br><span class="line">131</span><br><span class="line">132</span><br><span class="line">133</span><br><span class="line">134</span><br><span class="line">135</span><br><span class="line">136</span><br><span class="line">137</span><br><span class="line">138</span><br><span class="line">139</span><br><span class="line">140</span><br><span class="line">141</span><br><span class="line">142</span><br><span class="line">143</span><br><span class="line">144</span><br><span class="line">145</span><br><span class="line">146</span><br><span class="line">147</span><br><span class="line">148</span><br><span class="line">149</span><br><span class="line">150</span><br><span class="line">151</span><br><span class="line">152</span><br><span class="line">153</span><br><span class="line">154</span><br><span class="line">155</span><br><span class="line">156</span><br><span class="line">157</span><br><span class="line">158</span><br><span class="line">159</span><br><span class="line">160</span><br><span class="line">161</span><br><span class="line">162</span><br><span class="line">163</span><br><span class="line">164</span><br><span class="line">165</span><br><span class="line">166</span><br><span class="line">167</span><br><span class="line">168</span><br><span class="line">169</span><br><span class="line">170</span><br><span class="line">171</span><br><span class="line">172</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">import</span> React <span class="keyword">from</span> <span class="string">"react"</span>;</span><br><span class="line"><span class="keyword">import</span> &#123;</span><br><span class="line">  Form,</span><br><span class="line">  Modal,</span><br><span class="line">  Select,</span><br><span class="line">  Row,</span><br><span class="line">  Col,</span><br><span class="line">  Input,</span><br><span class="line">  DatePicker,</span><br><span class="line">  Upload,</span><br><span class="line">  Button,</span><br><span class="line">  Icon,</span><br><span class="line">  Spin,</span><br><span class="line">  InputNumber,</span><br><span class="line">  Radio,</span><br><span class="line">  TreeSelect</span><br><span class="line">&#125; <span class="keyword">from</span> <span class="string">"antd"</span>;</span><br><span class="line"><span class="keyword">import</span> styles <span class="keyword">from</span> <span class="string">"./ModalForm.less"</span>;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> &#123; TextArea &#125; = Input;</span><br><span class="line"></span><br><span class="line"><span class="keyword">const</span> radioStyle = &#123;</span><br><span class="line">  display: <span class="string">"block"</span>,</span><br><span class="line">  height: <span class="string">"30px"</span>,</span><br><span class="line">  lineHeight: <span class="string">"30px"</span></span><br><span class="line">&#125;;</span><br><span class="line"><span class="function"><span class="keyword">function</span> <span class="title">judgeInputType</span>(<span class="params">inputProps, options</span>) </span>&#123;</span><br><span class="line">  <span class="keyword">switch</span> (inputProps &amp;&amp; inputProps.type) &#123;</span><br><span class="line">    <span class="keyword">case</span> <span class="string">"treeSelect"</span>:</span><br><span class="line">      <span class="keyword">return</span> (</span><br><span class="line">        &lt;TreeSelect</span><br><span class="line">          treeData=&#123;options &amp;&amp; options.length &amp;&amp; options.length &gt; <span class="number">0</span> &amp;&amp; options&#125;</span><br><span class="line">        &gt;<span class="xml"><span class="tag">&lt;/<span class="name">TreeSelect</span>&gt;</span></span></span><br><span class="line">      );</span><br><span class="line">    <span class="keyword">case</span> <span class="string">"select"</span>:</span><br><span class="line">      <span class="keyword">return</span> (</span><br><span class="line">        &lt;Select&gt;</span><br><span class="line">          &#123;options.map(<span class="function">(<span class="params">val, idx</span>) =&gt;</span> (</span><br><span class="line">            &lt;Select.Option key=&#123;idx&#125; value=&#123;val[inputProps.selectProps.selVal]&#125;&gt;</span><br><span class="line">              &#123;val[inputProps.selectProps.selName]&#125;</span><br><span class="line">            &lt;<span class="regexp">/Select.Option&gt;</span></span><br><span class="line"><span class="regexp">          ))&#125;</span></span><br><span class="line"><span class="regexp">        &lt;/</span>Select&gt;</span><br><span class="line">      );</span><br><span class="line">    <span class="keyword">case</span> <span class="string">"date"</span>:</span><br><span class="line">      <span class="keyword">return</span> <span class="xml"><span class="tag">&lt;<span class="name">DatePicker</span> <span class="attr">style</span>=<span class="string">&#123;&#123;</span> <span class="attr">width:</span> "<span class="attr">100</span>%" &#125;&#125; /&gt;</span>;</span></span><br><span class="line"><span class="xml">    case "textarea":</span></span><br><span class="line">      return &lt;TextArea autosize /&gt;;</span><br><span class="line">    case "radio":</span><br><span class="line">      return (</span><br><span class="line">        &lt;Radio.Group style=&#123;&#123; marginLeft: "30px" &#125;&#125;&gt;</span><br><span class="line">          &#123;options.map((addr, idx) =&gt; &#123;</span><br><span class="line">            return (</span><br><span class="line">              &lt;Radio style=&#123;radioStyle&#125; value=&#123;addr.id&#125; key=&#123;addr.id || idx&#125;&gt;</span><br><span class="line">                选址-</span><br><span class="line">                &#123;idx + 1&#125;</span><br><span class="line">              &lt;/Radio&gt;</span><br><span class="line">            );</span><br><span class="line">          &#125;)&#125;</span><br><span class="line">        &lt;/Radio.Group&gt;</span><br><span class="line">      );</span><br><span class="line">    case "upload":</span><br><span class="line">      return (</span><br><span class="line">        &lt;Upload &#123;...inputProps.upLoadProps&#125;&gt;</span><br><span class="line">          &lt;Button&gt;</span><br><span class="line">            &lt;Icon type="upload" /&gt; 点击上传</span><br><span class="line">          &lt;/Button&gt;</span><br><span class="line">        &lt;/Upload&gt;</span><br><span class="line">      );</span><br><span class="line">    case "number":</span><br><span class="line">      return &lt;InputNumber style=&#123;&#123; width: "200px" &#125;&#125; /&gt;;</span><br><span class="line">    default:</span><br><span class="line">      return &lt;Input &#123;...(inputProps &amp;&amp; inputProps)&#125; /&gt;;</span><br><span class="line">  &#125;</span><br><span class="line">&#125;</span><br><span class="line"></span><br><span class="line">const WrapperModalFrom = Form.create()(</span><br><span class="line">  class ModalForm extends React.PureComponent &#123;</span><br><span class="line">    render() &#123;</span><br><span class="line">      const &#123;</span><br><span class="line">        form: &#123; getFieldDecorator &#125;,</span><br><span class="line">        formData,</span><br><span class="line">        isLoading,</span><br><span class="line">        style,</span><br><span class="line">        width,</span><br><span class="line">        formItemLayout,</span><br><span class="line">        isSpinLoading = false</span><br><span class="line">      &#125; = this.props;</span><br><span class="line">      console.log("formData: ", formData);</span><br><span class="line">      const &#123; record, modalTitle, ...formOther &#125; = formData &amp;&amp; formData;</span><br><span class="line">      return (</span><br><span class="line">        &lt;Modal</span><br><span class="line">          title=&#123;modalTitle&#125;</span><br><span class="line">          visible=&#123;this.props.visible&#125;</span><br><span class="line">          onOk=&#123;this.props.onOk&#125;</span><br><span class="line">          onCancel=&#123;this.props.onCancel&#125;</span><br><span class="line">          width=&#123;width&#125;</span><br><span class="line">          confirmLoading=&#123;isLoading&#125;</span><br><span class="line">          style=&#123;style&#125;</span><br><span class="line">          className=&#123;styles.modalForm&#125;</span><br><span class="line">        &gt;</span><br><span class="line">          &lt;Spin spinning=&#123;isSpinLoading&#125;&gt;</span><br><span class="line">            &lt;Form&gt;</span><br><span class="line">              &#123;formData &amp;&amp;</span><br><span class="line">                Object.keys(formOther).map((item, idx) =&gt; &#123;</span><br><span class="line">                  if (/groups/gi.test(item)) &#123;</span><br><span class="line">                    return (</span><br><span class="line">                      &lt;Row key=&#123;idx&#125; gutter=&#123;10&#125;&gt;</span><br><span class="line">                        &#123;Object.keys(formOther[item]).map((subItem, subIdx) =&gt; (</span><br><span class="line">                          &lt;Col</span><br><span class="line">                            span=&#123;24 / Object.keys(formOther[item]).length&#125;</span><br><span class="line">                            key=&#123;idx - subIdx&#125;</span><br><span class="line">                          &gt;</span><br><span class="line">                            &lt;Form.Item</span><br><span class="line">                              label=&#123;formOther[item][subItem].name&#125;</span><br><span class="line">                              &#123;...formItemLayout&#125;</span><br><span class="line">                            &gt;</span><br><span class="line">                              &#123;getFieldDecorator(</span><br><span class="line">                                `$&#123;formOther[item][subItem].actual&#125;`,</span><br><span class="line">                                &#123;</span><br><span class="line">                                  rules: [</span><br><span class="line">                                    ...(formOther[item][subItem].rules || [])</span><br><span class="line">                                  ],</span><br><span class="line">                                  initialValue: record[subItem] || ""</span><br><span class="line">                                &#125;</span><br><span class="line">                              )(</span><br><span class="line">                                judgeInputType(</span><br><span class="line">                                  formOther[item][subItem].inputProps,</span><br><span class="line">                                  formOther[item][subItem].options</span><br><span class="line">                                )</span><br><span class="line">                              )&#125;</span><br><span class="line">                            &lt;/Form.Item&gt;</span><br><span class="line">                          &lt;/Col&gt;</span><br><span class="line">                        ))&#125;</span><br><span class="line">                      &lt;/Row&gt;</span><br><span class="line">                    );</span><br><span class="line">                  &#125; else &#123;</span><br><span class="line">                    return (</span><br><span class="line">                      &lt;Form.Item</span><br><span class="line">                        label=&#123;formOther[item].name&#125;</span><br><span class="line">                        key=&#123;idx&#125;</span><br><span class="line">                        style=&#123;formOther[item].styles &amp;&amp; formOther[item].styles&#125;</span><br><span class="line">                        &#123;...formItemLayout&#125;</span><br><span class="line">                      &gt;</span><br><span class="line">                        &#123;getFieldDecorator(`$&#123;formOther[item].actual&#125;`, &#123;</span><br><span class="line">                          rules: [...(formOther[item].rules || [])],</span><br><span class="line">                          initialValue: record[item]</span><br><span class="line">                            ? formOther[item].inputProps &amp;&amp;</span><br><span class="line">                              formOther[item].inputProps.type === "select"</span><br><span class="line">                              ? String(record[item])</span><br><span class="line">                              : record[item]</span><br><span class="line">                            : ""</span><br><span class="line">                        &#125;)(</span><br><span class="line">                          judgeInputType(</span><br><span class="line">                            formOther[item].inputProps,</span><br><span class="line">                            formOther[item].options</span><br><span class="line">                          )</span><br><span class="line">                        )&#125;</span><br><span class="line">                      &lt;/Form.Item&gt;</span><br><span class="line">                    );</span><br><span class="line">                  &#125;</span><br><span class="line">                &#125;)&#125;</span><br><span class="line">            &lt;/Form&gt;</span><br><span class="line">          &lt;/Spin&gt;</span><br><span class="line">        &lt;/Modal&gt;</span><br><span class="line">      );</span><br><span class="line">    &#125;</span><br><span class="line">  &#125;</span><br><span class="line">);</span><br><span class="line"></span><br><span class="line">export default WrapperModalFrom;</span><br><span class="line">`</span><br></pre></td></tr></table></figure>
<ul>
<li>使用：</li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br><span class="line">9</span><br><span class="line">10</span><br><span class="line">11</span><br><span class="line">12</span><br><span class="line">13</span><br><span class="line">14</span><br><span class="line">15</span><br></pre></td><td class="code"><pre><span class="line">&lt;WrapModalFrom</span><br><span class="line">  ref=&#123;formProps&#125;</span><br><span class="line">  visible=&#123;modalShow&#125;</span><br><span class="line">  onOk=&#123;() =&gt; handleCreate()&#125;</span><br><span class="line">  onCancel=&#123;(e: any) =&gt; &#123;</span><br><span class="line">    <span class="built_in">console</span>.log(e);</span><br><span class="line">    setModalShow(<span class="literal">false</span>);</span><br><span class="line">  &#125;&#125;</span><br><span class="line">  formData=&#123;formData&#125;</span><br><span class="line">  isLoading=&#123;effects[<span class="string">'specialMerchant/add'</span>]&#125;</span><br><span class="line">  isSpinLoading=&#123;effects[<span class="string">'specialMerchant/getType'</span>] || <span class="literal">false</span>&#125;</span><br><span class="line">  width=&#123;<span class="string">'50%'</span>&#125;</span><br><span class="line">  formItemLayout=&#123;formItemLayout&#125;</span><br><span class="line">  style=&#123;&#123; <span class="attr">top</span>: <span class="string">'30px'</span>, <span class="attr">paddingBottom</span>: <span class="string">'0'</span> &#125;&#125;</span><br><span class="line">/&gt;</span><br></pre></td></tr></table></figure>
<ul>
<li><code>formProps</code></li>
</ul>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br></pre></td><td class="code"><pre><span class="line"><span class="keyword">const</span> formProps = useRef(<span class="literal">null</span>);</span><br><span class="line"><span class="comment">// 或者是React.createRef()</span></span><br><span class="line"><span class="comment">// 用来获取`modal`表单提交中的`form`相关属性</span></span><br></pre></td></tr></table></figure>
<p>例如： <code>handelCreate()</code><br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><span class="line">1</span><br><span class="line">2</span><br><span class="line">3</span><br><span class="line">4</span><br><span class="line">5</span><br><span class="line">6</span><br><span class="line">7</span><br><span class="line">8</span><br></pre></td><td class="code"><pre><span class="line">handleCreate = <span class="function"><span class="params">()</span> =&gt;</span> &#123;</span><br><span class="line">    formProps.current.validateFields(<span class="function">(<span class="params">err,values</span>) =&gt;</span> &#123;</span><br><span class="line">        <span class="keyword">if</span>(err) &#123;</span><br><span class="line">            <span class="keyword">return</span>;</span><br><span class="line">        &#125;</span><br><span class="line">        <span class="built_in">console</span>.log(<span class="string">'接收到的值为： '</span>,values);</span><br><span class="line">    &#125;)</span><br><span class="line">&#125;</span><br></pre></td></tr></table></figure></p>

      
    </div>

    
      
      

  <div class="post-copyright">
    <p class="copyright-item">
      <span>文章标题: </span>
      <a href="http://www.tiankai.party/posts/54457/">基于antd封装的模态框新增编辑组件</a>
    </p>
    <p class="copyright-item">
      <span>原文作者: </span>
      <a href="http://www.tiankai.party">tiankai</a>
    </p>
    <p class="copyright-item">
      <span>发表时间: </span>
      <span>
        2019-12-11, 17:12:07
      </span>
    </p>
    <p class="copyright-item">
      <span>最后更新: </span>
      <span>
        2019-12-25, 15:12:06
      </span>
    </p>

    <p class="copyright-item">
      <span>原文链接: </span>
      <a href="http://www.tiankai.party/posts/54457/">http://www.tiankai.party/posts/54457/</a>
    </p>
    <p class="copyright-item">
      <span>许可协议: </span>
      
      <a rel="license" href="http://creativecommons.org/licenses/by-nc/4.0/" target="_blank">知识共享署名-非商业性使用 4.0 国际许可协议</a>
    </p>
  </div>


      
      
  <div class="post-reward">
    <input type="checkbox" name="reward" id="reward" hidden>
    <label class="reward-button" for="reward">赞赏支持</label>
    <div class="qr-code">
      
      
        <label class="qr-code-image" for="reward">
          <img class="image" src="/imgs/wechat.jpg" title="wechat">
        </label>
      
      
        <label class="qr-code-image" for="reward">
          <img class="image" src="/imgs/ali.jpg" title="alipay">
        </label>
      
    </div>
  </div>

    

    
      <footer class="post-footer">
        
          <div class="post-tags">
            
              <a href="/tags/antd/">antd</a>
            
          </div>
        
        
        
  <nav class="post-nav">
    
      <a class="prev" href="/posts/62600/">
        <i class="iconfont icon-left"></i>
        <span class="prev-text nav-default">对fetch请求进行响应拦截处理</span>
        <span class="prev-text nav-mobile">上一篇</span>
      </a>
    
    
      <a class="next" href="/posts/12567/">
        <span class="next-text nav-default">试验一个npm包的生成</span>
        <span class="prev-text nav-mobile">下一篇</span>
        <i class="iconfont icon-right"></i>
      </a>
    
  </nav>


      </footer>
    

  </article>


          </div>
          
  <div class="comments" id="comments">
    
    <div id="gitalk-container"></div>
    
  </div>
  

        </div>
      </main>

      <footer id="footer" class="footer">

  <div class="social-links">
    
      
        
          <a href="mailto:tiankai0426@gmail.com" class="iconfont icon-email" title="email"></a>
        
      
    
      
    
      
    
      
    
      
    
      
    
      
        
          <a href="https://github.com/tiakia" class="iconfont icon-github" title="github"></a>
        
      
    
      
    
      
    
      
    
      
    
      
    
      
    

    
      <a href="/atom.xml" class="iconfont icon-rss" title="rss"></a>
    
  </div>



<div class="copyright">
  <span class="copyright-year">
    
    &copy; 
     
      2017 - 
    
    2019

    <span class="heart">
      <i class="iconfont icon-heart"></i>
    </span>
    <span class="author">tiankai</span>
  </span>
</div>

      </footer>

      <div class="back-to-top" id="back-to-top">
        <i class="iconfont icon-up"></i>
      </div>
    </div>

    
  
  

  
  
  <script>
     (function() {
         function render() {
             new Gitalk({
                 clientID: "d45abc7a6db571b50af9",
                 clientSecret: "15ab54f8f528045cdf07d8dbb2d4c0faa69f9462",
                 owner: 'tiakia',
                 repo: 'tiakiaBlogComment',
                 admin: ['tiakia'],
                 id: decodeURI(location.pathname)
             }).render('gitalk-container')
         }
         var gc = document.createElement('script');
         gc.type = 'text/javascript';
         gc.src = '//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.min.js';
         gc.charset = 'UTF-8';
         gc.onload = render;
         gc.async = true;
         document.querySelector('body').appendChild(gc);
         var gcs = document.createElement('link');
         gcs.href = '//cdn.jsdelivr.net/npm/gitalk@1/dist/gitalk.css';
         gcs.type = 'text/css';
         gcs.rel = 'stylesheet';
         gcs.media = 'screen,print';
         document.querySelector('head').appendChild(gcs);
     })();
    </script>

  



    
  



  
  





  
    <script type="text/javascript" src="/lib/jquery/jquery.min.js"></script>
  

  
    <script type="text/javascript" src="/lib/slideout/slideout.js"></script>
  

  
    <script type="text/javascript" src="/lib/fancybox/jquery.fancybox.pack.js"></script>
  

  
    <script type="text/javascript" src="/lib/pjax/jquery.pjax.min.js"></script>
  

  
    <script type="text/javascript" src="/lib/nprogress/nprogress.min.js"></script>
  


    <script type="text/javascript" src="/js/src/even.js?v=2.10.1"></script>

  </body>
</html>
